package Miu::Ext;
# типы файлов по расширению - указывают язык для блоков кода markdown

our %EXT = (
	"*.cls" => "LaTeX",
	"*.dtx" => "LaTeX",
	"*.ltx" => "LaTeX",
	"*.sty" => "LaTeX",
	"*.4gl" => "4GL",
	"*.a" => "Ada",
	"*.abc" => "ABC",
	"*.ada" => "Ada",
	"*.adb" => "Ada",
	"*.ado" => "Stata",
	"*.ads" => "Ada",
	"*.ahdl" => "AHDL",
	"*.ai" => "PostScript",
	"*.ans" => "Ansys",
	"*.asm" => "assembler", # AVR Assembler, Asm6502, Intel x86 (NASM), PicAsm
	"*.asm-avr" => "assembler", # AVR Assembler
	"*.asp" => "ASP",
	"*.awk" => "AWK",
	"*.bas" => "FreeBASIC",
	"*.basetest" => "BaseTest",
	"*.bash" => "Bash",
	"*.bi" => "FreeBASIC",
	"*.bib" => "BibTeX",
	"*.bro" => "Component-Pascal",
	"*.c" => "C", # ANSI C89, LPC
	"*.C" => "C++", # C, ANSI C89
	"*.c++" => "C++",
	"*.cc" => "C++",
	"*.cfc" => "ColdFusion",
	"*.cfg" => "Quake Script",
	"*.cfm" => "ColdFusion",
	"*.cfml" => "ColdFusion",
	"*.cg" => "Cg",
	"*.cgis" => "CGiS",
	"*.ch" => "xHarbour", # Clipper
	"*.cis" => "Cisco",
	"*.cl" => "lisp",
	"*.cmake" => "CMake",
	"*.config" => "Logtalk",
	"*.cp" => "Component-Pascal",
	"cpanfile" => "perl",
	"*.cpp" => "C++",
	"*.cs" => "C#",
	"*.css" => "CSS",
	"*.cue" => "CUE Sheet",
	"*.cxx" => "C++",
	"*.d" => "D",
	"*.daml" => "XML",
	"*.dbm" => "ColdFusion",
	"*.def" => "Modula-2",
	"*.desktop" => ".desktop",
	"*.diff" => "Diff",
	"*.do" => "Stata",
	"*.docbook" => "XML",
	"*.dox" => "Doxygen",
	"*.doxygen" => "Doxygen",
	"*.e" => "E Language", # Eiffel, Euphoria
	"*.ebuild" => "Bash",
	"*.eclass" => "Bash",
	"*.eml" => "Email",
	"*.eps" => "PostScript",
	"*.err" => "4GL",
	"*.ex" => "Euphoria",
	"*.exu" => "Euphoria",
	"*.exw" => "Euphoria",
	"*.f" => "fortran",
	"*.f90" => "fortran",
	"*.f95" => "fortran",
	"*.fe" => "ferite",
	"*.feh" => "ferite",
	"*.flex" => "Lex/Flex",
	"*.for" => "fortran",
	"*.fpp" => "fortran",
	"*.frag" => "GLSL",
	"*.gdl" => "GDL",
	"*.glsl" => "GLSL",
	"*.guile" => "Scheme",
	"*.h" => "C", # C, ANSI C89, Inform, LPC, Objective-C
	"*.h++" => "C++",
	"*.hcc" => "C++",
	"*.hpp" => "C++",
	"*.hs" => "Haskell",
	"*.hsp" => "Spice",
	"*.ht" => "Apache Configuration",
	"*.htm" => "html",
	"*.html" => "html", # Mason
	"*.hxx" => "C++",
	"*.i" => "progress",
	"*.idl" => "IDL",
	"*.inc" => "POV-Ray", # php, LPC
	"*.inf" => "Inform",
	"*.ini" => "INI Files",
	"*.java" => "Java",
	"*.js" => "JavaScript",
	"*.jsp" => "JSP",
	"*.katetemplate" => "kate", # Kate File Template
	"*.kbasic" => "KBasic",
	"*.kdelnk" => ".desktop",
	"*.l" => "Lex/Flex",
	"*.ldif" => "LDIF",
	"*.lex" => "Lex/Flex",
	"*.lgo" => "de_DE", # en_US, nl
	"*.lgt" => "Logtalk",
	"*.lhs" => "Literate Haskell",
	"*.lisp" => "lisp",
	"*.logo" => "de_DE", # en_US, nl
	"*.lsp" => "lisp",
	"*.lua" => "Lua",
	"*.ly" => "LilyPond",
	"*.m" => "Matlab", # Objective-C, Octave
	"*.m3u" => "M3U",
	"*.mab" => "MAB-DB",
	"*.md" => "Modula-2",
	"*.mi" => "Modula-2",
	"*.ml" => "Objective Caml", # SML
	"*.mli" => "Objective Caml",
	"*.moc" => "C++",
	"*.mod" => "Modula-2",
	"*.mup" => "Music Publisher",
	"*.not" => "Music Publisher",
	"*.o" => "LPC",
	"*.octave" => "Octave",
	"*.p" => "pascal", # progress
	"*.pas" => "pascal",
	"*.pb" => "PureBasic",
	"*.per" => "4GL-PER",
	"*.PER" => "4GL-PER",
	"*.per.err" => "4GL-PER",
	"*.php" => "php",
	"*.php3" => "php",
	"*.phtm" => "php",
	"*.phtml" => "php",
	"*.pic" => "PicAsm",
	"*.pike" => "Pike",
	"*.pl" => "perl",
	"*.pls" => "ini",
	"*.pm" => "perl",
	"*.po" => "gettext",	# GNU Gettext
	"*.pot" => "gettext",	# GNU Gettext
	"*.pov" => "POV-Ray",
	"*.pp" => "pascal",
	"*.prg" => "xHarbour", # Clipper
	"*.pro" => "RSI IDL",
	"*.prolog" => "Prolog",
	"*.ps" => "PostScript",
	"*.py" => "Python",
	"*.pyw" => "Python",
	"*.R" => "R Script",
	"*.rb" => "Ruby",
	"*.rc" => "XML",
	"*.rdf" => "XML",
	"*.reg" => "WINE Config",
	"*.rex" => "REXX",
	"*.rib" => "RenderMan RIB",
	"*.s" => "GNU Assembler", # MIPS Assembler
	"*.sa" => "Sather",
	"*.sce" => "scilab",
	"*.scheme" => "Scheme",
	"*.sci" => "scilab",
	"*.scm" => "Scheme",
	"*.sgml" => "SGML",
	"*.sh" => "Bash",
	"*.shtm" => "HTML",
	"*.shtml" => "HTML",
	"*.siv" => "Sieve",
	"*.sml" => "SML",
	"*.sp" => "Spice",
	"*.spec" => "RPM Spec",
	"*.sql" => "SQL", # SQL (MySQL), SQL (PostgreSQL)
	"*.src" => "PicAsm",
	"*.SRC" => "PicAsm",
	"*.ss" => "Scheme",
	"*.t2t" => "txt2tags",
	"*.tcl" => "Tcl/Tk",
	"*.tdf" => "AHDL",
	"*.tex" => "LaTeX",
	"*.tji" => "TaskJuggler",
	"*.tjp" => "TaskJuggler",
	"*.tk" => "Tcl/Tk",
	"*.tst" => "BaseTestchild",
	"*.uc" => "UnrealScript",
	"*.v" => "verilog",
	"*.vcg" => "GDL",
	"*.vert" => "GLSL",
	"*.vhd" => "VHDL",
	"*.vhdl" => "VHDL",
	"*.vl" => "verilog",
	"*.vm" => "velocity",
	"*.w" => "progress",
	"*.wml" => "php",
	"*.wrl" => "VRML",
	"*.xml" => "XML",
	"*.xsl" => "xslt",
	"*.xslt" => "xslt",
	"*.y" => "Yacc/Bison",
	"*.ys" => "yacas",
	"*Makefile*" => "Makefile",
	"*patch" => "Diff",
	"apache.conf" => "Apache Configuration",
	"apache2.conf" => "Apache Configuration",
	"ChangeLog" => "ChangeLog",
	"CMakeLists.txt" => "CMake",
	"httpd.conf" => "Apache Configuration",
	"httpd2.conf" => "Apache Configuration",
	"QRPGLESRC.*" => "ILERPG",
	"xorg.conf" => "x.org Configuration",
);

use List::Util qw/pairmap pairgrep/;
our @RE = pairmap { my $x=quotemeta $a; $x=~s/\\\*/.*/g; (qr/^$x$/i, $a) } %EXT;

# находит язык
sub get_lang {
	my ($self, $file) = @_;
	
	($file) = $file =~ m!([^/]+)$!;
	
	my @res = pairgrep { $file =~ $a } @RE;
	!@res && return "";
	$EXT{$res[1]} // ""
}

1;